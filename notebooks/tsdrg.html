
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>4.7.1. Algorithm &#8212; tnpy 0.1.1a3 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. Model 1D" href="../model/model_1d.html" />
    <link rel="prev" title="4.6. tnpy.tsdrg.ShiftInvertTreeTensorNetworkSDRG" href="../algorithm/_autosummary/tnpy.tsdrg.ShiftInvertTreeTensorNetworkSDRG.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">tnpy 0.1.1a3 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Algorithms
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../algorithm/exact_diagonalization.html">
   1. Exact Diagonalization (ED)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.exact_diagonalization.ExactDiagonalization.html">
     1.1. tnpy.exact_diagonalization.ExactDiagonalization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../algorithm/finite_dmrg.html">
   2. Finite Density Matrix Renormalization Group (fDMRG)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.finite_dmrg.FiniteDMRG.html">
     2.1. tnpy.finite_dmrg.FiniteDMRG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.finite_dmrg.ShiftInvertDMRG.html">
     2.2. tnpy.finite_dmrg.ShiftInvertDMRG
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../algorithm/finite_tdvp.html">
   3. Finite Time-dependent Variational Principle (fTDVP)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.finite_tdvp.FiniteTDVP.html">
     3.1. tnpy.finite_tdvp.FiniteTDVP
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../algorithm/tsdrg.html">
   4. Tree Tensor Strong-disorder Renormalization Group (tSDRG)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.tsdrg.Node.html">
     4.1. tnpy.tsdrg.Node
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.tsdrg.TensorTree.html">
     4.2. tnpy.tsdrg.TensorTree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.tsdrg.TreeTensorNetworkSDRG.html">
     4.3. tnpy.tsdrg.TreeTensorNetworkSDRG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.tsdrg.TreeTensorNetworkMeasurements.html">
     4.4. tnpy.tsdrg.TreeTensorNetworkMeasurements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.tsdrg.HighEnergyTreeTensorNetworkSDRG.html">
     4.5. tnpy.tsdrg.HighEnergyTreeTensorNetworkSDRG
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../algorithm/_autosummary/tnpy.tsdrg.ShiftInvertTreeTensorNetworkSDRG.html">
     4.6. tnpy.tsdrg.ShiftInvertTreeTensorNetworkSDRG
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.7.1. Algorithm
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Built-in models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model/model_1d.html">
   1. Model 1D
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../model/_autosummary/tnpy.model.Model1D.html">
     1.1. tnpy.model.Model1D
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model/xxz.html">
   2. XXZ model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../model/_autosummary/tnpy.model.XXZ.html">
     2.1. tnpy.model.XXZ
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model/dimer_xxz.html">
   3. Dimer XXZ model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../model/_autosummary/tnpy.model.DimerXXZ.html">
     3.1. tnpy.model.DimerXXZ
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model/random_heisenberg.html">
   4. Random Heisenberg model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../model/_autosummary/tnpy.model.RandomHeisenberg.html">
     4.1. tnpy.model.RandomHeisenberg
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model/thirring.html">
   5. Thirring model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../model/_autosummary/tnpy.model.Thirring.html">
     5.1. tnpy.model.Thirring
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model/total_sz.html">
   6. Total Sz
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../model/_autosummary/tnpy.model.TotalSz.html">
     6.1. tnpy.model.TotalSz
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../model/utils.html">
   7. Utils
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../model/_autosummary/tnpy.model.utils.html">
     7.1. tnpy.model.utils
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Operators and linear algebra
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../matrix_product_state.html">
   1. Matrix Product State (MPS)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.matrix_product_state.Direction.html">
     1.1. tnpy.matrix_product_state.Direction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.matrix_product_state.MatrixProductState.html">
     1.2. tnpy.matrix_product_state.MatrixProductState
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.matrix_product_state.Environment.html">
     1.3. tnpy.matrix_product_state.Environment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.matrix_product_state.MatrixProductStateMeasurements.html">
     1.4. tnpy.matrix_product_state.MatrixProductStateMeasurements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../operators.html">
   2. Matrix Product Operator (MPO) &amp; others
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.operators.MatrixProductOperator.html">
     2.1. tnpy.operators.MatrixProductOperator
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.operators.SpinOperators.html">
     2.2. tnpy.operators.SpinOperators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.operators.FullHamiltonian.html">
     2.3. tnpy.operators.FullHamiltonian
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linalg.html">
   3. Linear Algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../_autosummary/tnpy.linalg.html">
     3.1. tnpy.linalg
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/tanlin2013/tnpy"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/tanlin2013/tnpy/issues/new?title=Issue%20on%20page%20%2Fnotebooks/tsdrg.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/tanlin2013/tnpy/edit/master/docs/notebooks/tsdrg.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   4.7.1. Algorithm
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Preparation">
     4.7.1.1. Preparation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Main-part:-growing-the-tree">
     4.7.1.2. Main part: growing the tree
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Data-Structure">
   4.7.2. Data Structure
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Measurements">
   4.7.3. Measurements
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Near-ground-state-energies">
     4.7.3.1. Near-ground-state energies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Correlation-function">
     4.7.3.2. Correlation function
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Depth-first-Search-(DFS)-&amp;-Common-Ancestor">
     4.7.3.3. Depth-first Search (DFS) &amp; Common Ancestor
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Entanglement-entropy">
     4.7.3.4. Entanglement entropy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#References">
   4.7.4. References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Algorithm</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   4.7.1. Algorithm
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Preparation">
     4.7.1.1. Preparation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Main-part:-growing-the-tree">
     4.7.1.2. Main part: growing the tree
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Data-Structure">
   4.7.2. Data Structure
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Measurements">
   4.7.3. Measurements
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Near-ground-state-energies">
     4.7.3.1. Near-ground-state energies
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Correlation-function">
     4.7.3.2. Correlation function
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Depth-first-Search-(DFS)-&amp;-Common-Ancestor">
     4.7.3.3. Depth-first Search (DFS) &amp; Common Ancestor
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Entanglement-entropy">
     4.7.3.4. Entanglement entropy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#References">
   4.7.4. References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Algorithm">
<h1><span class="section-number">4.7.1. </span>Algorithm<a class="headerlink" href="#Algorithm" title="Permalink to this headline">#</a></h1>
<section id="Preparation">
<h2><span class="section-number">4.7.1.1. </span>Preparation<a class="headerlink" href="#Preparation" title="Permalink to this headline">#</a></h2>
<ol class="arabic simple">
<li><p>Decompose Hamiltonian (of an 1D system) into MPO form.</p></li>
<li><p>Calculate the 2-site Hamiltonian for each nearest-neighbor <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(i+1\)</span>.</p></li>
</ol>
<p>This can be done in the following way. Suppose we have the following MPO on site <span class="math notranslate nohighlight">\(i\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}W_i =
   \begin{bmatrix}
       I &amp; S^+_i &amp; S^z_i \\
       0 &amp; 0 &amp; S^-_i \\
       0 &amp; 0 &amp; I
   \end{bmatrix}\end{split}\]</div>
<p>By considering the product of the left vector <span class="math notranslate nohighlight">\(W^{[L]}\)</span> and the right vector <span class="math notranslate nohighlight">\(W^{[R]}\)</span> on site <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(i+1\)</span>, respectively, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}W^{[L]}_i W^{[R]}_{i+1} \\
= \begin{bmatrix}
    I &amp; S^+_i &amp; S^z_i
   \end{bmatrix}
\begin{bmatrix}
    S^z_{i+1}\\
    S^-_{i+1} \\
    I
\end{bmatrix},\end{split}\]</div>
<p>where the left vector is taken from the 1st row of the MPO, and the right vector is taken from the last column of the MPO. The vector product immediately yields the 2-site Hamiltonian.</p>
<blockquote>
<div><p><strong>Note:</strong> The example here is the Ising model with transverse field.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Compute the energy spectrum (eigenvalues) for every 2-site Hamiltonian.</p></li>
<li><p>Considering the bond dimension <span class="math notranslate nohighlight">\(\chi\)</span> to be the number of eigenvectors that will be preserved later. We define the energy gap <span class="math notranslate nohighlight">\(\Delta_{\chi}\)</span> to be</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta_{\chi} =
\begin{cases}
    E_N - E_{N-1} \,\,\,\,\,when \,\,\chi \geq k - 1,\\
    E_{\chi+1} - E_{\chi} \,\,\,\,\,when \,\,\chi &lt; k - 1,
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is the total number of eigenvectors.</p>
</section>
<section id="Main-part:-growing-the-tree">
<h2><span class="section-number">4.7.1.2. </span>Main part: growing the tree<a class="headerlink" href="#Main-part:-growing-the-tree" title="Permalink to this headline">#</a></h2>
<div><p><img alt="11ce209dafec442e863ab4aee9992065" class="no-scaled-link" src="../_images/tsdrg1.png" style="width: 300px;" />   <img alt="66f166f775b64425978ab0a3a5ef87f5" class="no-scaled-link" src="../_images/tsdrg2.png" style="width: 300px;" /></p>
</div><ol class="arabic simple">
<li><p>Merge the 2-site block with largest energy gap. This can be performed by constructing the isometric tensor <span class="math notranslate nohighlight">\(V\)</span> (the triangular tensor in the figure) to be <span class="math notranslate nohighlight">\(min(\chi, k)\)</span> eigenvectors of the 2-site Hamiltonian. By contracting <span class="math notranslate nohighlight">\(V^{\dagger}\)</span> and <span class="math notranslate nohighlight">\(V\)</span> with 2 MPO tensors, one gets the updated MPO.</p></li>
<li><p>Compute the energy spectrum and the energy gap accordingly for affected block with its neighbors.</p></li>
<li><p>Repeat this procedure until there is only one MPO tensor remained.</p></li>
</ol>
<blockquote>
<div><p>Note: The isometric tensor at each step should be saved for later usage.</p>
</div></blockquote>
</section>
</section>
<section id="Data-Structure">
<h1><span class="section-number">4.7.2. </span>Data Structure<a class="headerlink" href="#Data-Structure" title="Permalink to this headline">#</a></h1>
<p>The problem considered here essentially forms a random binary tree. Though the construction of this tree is bottom-up, the data structure takes the same as in the standard top-down approach. Here we take Python for implementation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">left</span><span class="p">:</span> <span class="s1">&#39;Node&#39;</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">right</span><span class="p">:</span> <span class="s1">&#39;Node&#39;</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>In class <code class="docutils literal notranslate"><span class="pre">Node</span></code>, for each attribute we mean</p>
<ul class="simple">
<li><p><strong>id:</strong> The identity of each tree node</p></li>
<li><p><strong>value:</strong> Data you want to save. Here it will be the isometric tensor <span class="math notranslate nohighlight">\(V\)</span>.</p></li>
<li><p><strong>left:</strong> The child tree node on the left.</p></li>
<li><p><strong>right:</strong> The child tree node on the right.</p></li>
</ul>
</section>
<section id="Measurements">
<h1><span class="section-number">4.7.3. </span>Measurements<a class="headerlink" href="#Measurements" title="Permalink to this headline">#</a></h1>
<p>We consider 3 physical measurements, energy spectrum near the ground state, correlation function and entanglement entropy. For latter two, one needs to consider the problem of lowest common ancestor (LCA) in graph theory and computer science.</p>
<section id="Near-ground-state-energies">
<h2><span class="section-number">4.7.3.1. </span>Near-ground-state energies<a class="headerlink" href="#Near-ground-state-energies" title="Permalink to this headline">#</a></h2>
<p>We may compare the tSDRG result with exact diagonalization (ED)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tnpy.model</span> <span class="kn">import</span> <span class="n">RandomHeisenberg</span>
<span class="kn">from</span> <span class="nn">tnpy.exact_diagonalization</span> <span class="kn">import</span> <span class="n">ExactDiagonalization</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">RandomHeisenberg</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
<span class="n">ed</span> <span class="o">=</span> <span class="n">ExactDiagonalization</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">mpo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ed</span><span class="o">.</span><span class="n">evals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-5.725274   -5.72107734 -4.74615997 -4.71268557 -4.06178764 -3.51217086
 -3.25686868 -3.1702727  -3.08738826 -2.96569967 -2.96208476 -2.36976171
 -2.2468987  -1.96518603 -1.93061032 -1.66092774 -1.63521806 -1.53696184
 -1.53608151 -1.50235556 -1.3824775  -1.30353663 -1.28495105 -0.74151444
 -0.48708556 -0.46889621 -0.38280498 -0.32933783  0.02287853  0.02405187
  0.11860807  0.14026275  0.25916564  0.26466405  0.29724328  0.41903877
  0.52586047  0.57210892  0.73767002  0.99008145  0.99912061  1.28296561
  1.39148235  1.50087939  1.58252137  1.62971816  1.79899183  1.80060276
  1.82251982  2.32711     2.35072418  2.42976868  2.51529568  2.62638576
  2.77518678  2.78965217  3.0927528   3.37982529  3.39238364  3.40923678
  3.59608887  4.2094474   4.42301798  5.18876342]
</pre></div></div>
</div>
<p>whereas for tSDRG, and with truncated bond dimensions <span class="math notranslate nohighlight">\(\chi &lt; 2^N\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tnpy.tsdrg</span> <span class="kn">import</span> <span class="n">TreeTensorNetworkSDRG</span>

<span class="n">tsdrg</span> <span class="o">=</span> <span class="n">TreeTensorNetworkSDRG</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">mpo</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">tsdrg</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2021-10-29 15:06:37 [tsdrg.py] INFO: step 1, merging TreeNode(4) and TreeNode(5) to TreeNode(7)
2021-10-29 15:06:37 [tsdrg.py] INFO: step 2, merging TreeNode(2) and TreeNode(3) to TreeNode(8)
2021-10-29 15:06:37 [tsdrg.py] INFO: step 3, merging TreeNode(0) and TreeNode(1) to TreeNode(9)
2021-10-29 15:06:37 [tsdrg.py] INFO: step 4, merging TreeNode(8) and TreeNode(7) to TreeNode(10)
2021-10-29 15:06:37 [tsdrg.py] INFO: step 5, merging TreeNode(9) and TreeNode(10) to TreeNode(11)
2021-10-29 15:06:37 [tsdrg.py] INFO: Reach head node of the tree
2021-10-29 15:06:37 [tsdrg.py] INFO: Obtain ground state energies [-5.72520711 -5.72105886 -4.70924236 -4.65539092]
</pre></div></div>
</div>
<p>but if we take the maximum bond dimensions <span class="math notranslate nohighlight">\(\chi = 2^N\)</span>, which is 64 here, then the result will then be exact.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tsdrg</span> <span class="o">=</span> <span class="n">TreeTensorNetworkSDRG</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">mpo</span><span class="p">,</span> <span class="n">chi</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">tsdrg</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2021-10-29 12:39:01 [tsdrg.py] INFO: step 1, merging TreeNode(4) and TreeNode(5) to TreeNode(7)
2021-10-29 12:39:01 [tsdrg.py] INFO: step 2, merging TreeNode(2) and TreeNode(3) to TreeNode(8)
2021-10-29 12:39:01 [tsdrg.py] INFO: step 3, merging TreeNode(8) and TreeNode(7) to TreeNode(9)
2021-10-29 12:39:01 [tsdrg.py] INFO: step 4, merging TreeNode(1) and TreeNode(9) to TreeNode(10)
2021-10-29 12:39:02 [tsdrg.py] INFO: step 5, merging TreeNode(0) and TreeNode(10) to TreeNode(11)
2021-10-29 12:39:02 [tsdrg.py] INFO: Reach head node of the tree
2021-10-29 12:39:02 [tsdrg.py] INFO: Obtain ground state energies [-5.725274   -5.72107734 -4.74615997 -4.71268557 -4.06178764 -3.51217086
 -3.25686868 -3.1702727  -3.08738826 -2.96569967 -2.96208476 -2.36976171
 -2.2468987  -1.96518603 -1.93061032 -1.66092774 -1.63521806 -1.53696184
 -1.53608151 -1.50235556 -1.3824775  -1.30353663 -1.28495105 -0.74151444
 -0.48708556 -0.46889621 -0.38280498 -0.32933783  0.02287853  0.02405187
  0.11860807  0.14026275  0.25916564  0.26466405  0.29724328  0.41903877
  0.52586047  0.57210892  0.73767002  0.99008145  0.99912061  1.28296561
  1.39148235  1.50087939  1.58252137  1.62971816  1.79899183  1.80060276
  1.82251982  2.32711     2.35072418  2.42976868  2.51529568  2.62638576
  2.77518678  2.78965217  3.0927528   3.37982529  3.39238364  3.40923678
  3.59608887  4.2094474   4.42301798  5.18876342]
</pre></div></div>
</div>
</section>
<section id="Correlation-function">
<h2><span class="section-number">4.7.3.2. </span>Correlation function<a class="headerlink" href="#Correlation-function" title="Permalink to this headline">#</a></h2>
<div><p><img alt="ebea668e6d7e47fa9ff5ca0aa6c00dc0" class="no-scaled-link" src="../_images/tsdrg3.png" style="width: 800px;" /></p>
</div></section>
<section id="Depth-first-Search-(DFS)-&amp;-Common-Ancestor">
<h2><span class="section-number">4.7.3.3. </span>Depth-first Search (DFS) &amp; Common Ancestor<a class="headerlink" href="#Depth-first-Search-(DFS)-&-Common-Ancestor" title="Permalink to this headline">#</a></h2>
</section>
<section id="Entanglement-entropy">
<h2><span class="section-number">4.7.3.4. </span>Entanglement entropy<a class="headerlink" href="#Entanglement-entropy" title="Permalink to this headline">#</a></h2>
</section>
</section>
<section id="References">
<h1><span class="section-number">4.7.4. </span>References<a class="headerlink" href="#References" title="Permalink to this headline">#</a></h1>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.96.064427">Griffiths singularities in the random quantum Ising antiferromagnet: A tree tensor network renormalization group study</a></p></li>
<li><p><a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.89.214203">Self-assembling tensor networks and holography in disordered spin chains</a></p></li>
</ol>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../algorithm/_autosummary/tnpy.tsdrg.ShiftInvertTreeTensorNetworkSDRG.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.6. </span>tnpy.tsdrg.ShiftInvertTreeTensorNetworkSDRG</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../model/model_1d.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Model 1D</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Tan Tao-Lin<br/>
  
      &copy; Copyright 2023, Tan Tao-Lin.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>