
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Algorithm ðŸš€ &#8212; tnpy 0.0.3 documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Model Base" href="model_base.html" />
    <link rel="prev" title="tnpy.tsdrg.TSDRG" href="_autosummary/tnpy.tsdrg.TSDRG.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">tnpy 0.0.3 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption" role="heading">
 <span class="caption-text">
  Algorithms
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="finite_dmrg.html">
   Finite Density Matrix Renormalization Group (fDMRG)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.finite_dmrg.FiniteDMRG.html">
     tnpy.finite_dmrg.FiniteDMRG
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="finite_tdvp.html">
   Finite Time-dependent Variational Principle (fTDVP)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.finite_tdvp.FiniteTDVP.html">
     tnpy.finite_tdvp.FiniteTDVP
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="tsdrg.html">
   Tree Tensor Strong-disorder Renormalization Group (tSDRG)
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.tsdrg.TreeNode.html">
     tnpy.tsdrg.TreeNode
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.tsdrg.TensorTree.html">
     tnpy.tsdrg.TensorTree
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.tsdrg.TSDRG.html">
     tnpy.tsdrg.TSDRG
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     1. Algorithm ðŸš€
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Built-in Models
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="model_base.html">
   Model Base
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.model.ModelBase.html">
     tnpy.model.ModelBase
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="xxz.html">
   XXZ model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.model.XXZ.html">
     tnpy.model.XXZ
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="dimer_xxz.html">
   Dimer XXZ model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.model.DimerXXZ.html">
     tnpy.model.DimerXXZ
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="random_heisenberg.html">
   Random Heisenberg model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.model.RandomHeisenberg.html">
     tnpy.model.RandomHeisenberg
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="thirring.html">
   Thirring model
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.model.Thirring.html">
     tnpy.model.Thirring
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Helper class
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="operators.html">
   Matrix Product Operator (MPO) &amp; others
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.operators.MPO.html">
     tnpy.operators.MPO
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.operators.SpinOperators.html">
     tnpy.operators.SpinOperators
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="linalg.html">
   Linear Algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_autosummary/tnpy.linalg.html">
     tnpy.linalg
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  API Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="tnpy.html">
   tnpy package
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="tnpy.model.html">
     tnpy.model package
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/tanlin2013/tnpy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/tanlin2013/tnpy/issues/new?title=Issue%20on%20page%20%2Fnb_tsdrg.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/tanlin2013/tnpy/edit/master/docs/nb_tsdrg.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   1. Algorithm ðŸš€
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Preparation">
     1.1. Preparation
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Main-part:-growing-the-tree">
     1.2. Main part: growing the tree
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Data-Structure-ðŸš€">
   2. Data Structure ðŸš€
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Measurements-ðŸš€">
   3. Measurements ðŸš€
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Correlation-function">
     3.1. Correlation function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Depth-first-Search-(DFS)-&amp;-Common-Ancestor">
       3.1.1. Depth-first Search (DFS) &amp; Common Ancestor
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Entanglement-entropy">
     3.2. Entanglement entropy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#References-ðŸš€">
   4. References ðŸš€
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Algorithm-ðŸš€">
<h1><span class="section-number">1. </span>Algorithm ðŸš€<a class="headerlink" href="#Algorithm-ðŸš€" title="Permalink to this headline">Â¶</a></h1>
<div class="section" id="Preparation">
<h2><span class="section-number">1.1. </span>Preparation<a class="headerlink" href="#Preparation" title="Permalink to this headline">Â¶</a></h2>
<ol class="arabic simple">
<li><p>Decompose Hamiltonian (of an 1D system) into MPO form.</p></li>
<li><p>Calculate the 2-site Hamiltonian for each nearest-neighbor <span class="math">i</span> and <span class="math">i+1</span>.</p></li>
</ol>
<blockquote>
<div><p>ðŸ‘‰ This can be done in the following way. Suppose we have the following MPO on site <span class="math">i</span>,</p>
<div class="math">
<p><span class="math">W_i =
\begin{bmatrix}
I &amp; S^+_i &amp; S^z_i\\
0 &amp; 0 &amp; S^-_i \\
0 &amp; 0 &amp; I
\end{bmatrix}</span></p>
</div><p>By considering the product of the left vector <span class="math">W^{[L]}</span> and the right vector <span class="math">W^{[R]}</span> on site <span class="math">i</span> and <span class="math">i+1</span>, respectively, we have</p>
<div class="math">
<p><span class="math">W^{[L]}_i W^{[R]}_{i+1} \\
= \begin{bmatrix}
I &amp; S^+_i &amp; S^z_i
\end{bmatrix}
\begin{bmatrix}
S^z_{i+1}\\
S^-_{i+1} \\
I
\end{bmatrix},</span></p>
</div><p>where the left vector is taken from the 1st row of the MPO, and the right vector is taken from the last column of the MPO. The vector product immediately yields the 2-site Hamiltonian.</p>
<p><strong>Note:</strong> The example here is the Ising model with transverse field.</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Compute the energy spectrum (eigenvalues) for every 2-site Hamiltonian.</p></li>
<li><p>Considering the bond dimension <span class="math">\chi</span> to be the number of eigenvectors that will be preserved later. We define the energy gap <span class="math">\Delta_{\chi}</span> to be</p></li>
</ol>
<div class="math">
<p><span class="math">\Delta_{\chi} =
\begin{cases}
    E_N - E_{N-1} \,\,\,\,\,when \,\,\chi \geq N - 1,\\
    E_{\chi+1} - E_{\chi} \,\,\,\,\,when \,\,\chi &lt; N - 1,
\end{cases}</span></p>
</div><p>where <span class="math">N</span> is the total number of eigenvectors.</p>
</div>
<div class="section" id="Main-part:-growing-the-tree">
<h2><span class="section-number">1.2. </span>Main part: growing the tree<a class="headerlink" href="#Main-part:-growing-the-tree" title="Permalink to this headline">Â¶</a></h2>
<div><p><img alt="fc496b9d40074d559ca3aa71ac180486" class="no-scaled-link" src="_images/tsdrg1.png" style="width: 300px;" /> Â  <img alt="c9c76617caf54f6bbf329d6d8d76bd45" class="no-scaled-link" src="_images/tsdrg2.png" style="width: 300px;" /></p>
</div><ol class="arabic simple">
<li><p>Merge the 2-site block with largest energy gap. This can be performed by constructing the isometric tensor <span class="math">V</span> (the triangular tensor in the figure) to be <span class="math">min(\chi, N)</span> eigenvectors of the 2-site Hamiltonian. By contracting <span class="math">V^{\dagger}</span> and <span class="math">V</span> with 2 MPO tensors, one gets the updated MPO.</p></li>
<li><p>Compute the energy spectrum and the energy gap accordingly for affected block with its neighbors.</p></li>
<li><p>Repeat this procedure until there is only one MPO tensor remained.</p></li>
</ol>
<blockquote>
<div><p>Note: The isometric tensor at each step should be saved for later usage.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="Data-Structure-ðŸš€">
<h1><span class="section-number">2. </span>Data Structure ðŸš€<a class="headerlink" href="#Data-Structure-ðŸš€" title="Permalink to this headline">Â¶</a></h1>
<p>The problem considered here essentially forms a random binary tree. Though the construction of this tree is bottom-up, the data structure takes the same as in the standard top-down approach. Here we take Python for implementation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">TreeNode</span><span class="p">:</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">left</span><span class="p">:</span> <span class="s1">&#39;TreeNode&#39;</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">right</span><span class="p">:</span> <span class="s1">&#39;TreeNode&#39;</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>In class <code class="docutils literal notranslate"><span class="pre">TreeNode</span></code>, for each attribute we mean</p>
<ul class="simple">
<li><p><strong>id:</strong> The identity of each tree node</p></li>
<li><p><strong>value:</strong> Data you want to save. Here it will be the isometric tensor <span class="math">V</span>.</p></li>
<li><p><strong>left:</strong> The child tree node on the left.</p></li>
<li><p><strong>right:</strong> The child tree node on the right.</p></li>
</ul>
</div>
<div class="section" id="Measurements-ðŸš€">
<h1><span class="section-number">3. </span>Measurements ðŸš€<a class="headerlink" href="#Measurements-ðŸš€" title="Permalink to this headline">Â¶</a></h1>
<p>We consider 3 physical measurements, energy spectrum near the ground state, correlation function and entanglement entropy. For latter two, one needs to consider the problem of lowest common ancestor (LCA) in graph theory and computer science.</p>
<p>We may compare the tSDRG result with exact diagonalization (ED)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from tnpy.model import RandomHeisenberg
from tnpy.exact_diagonalization import ExactDiagonalization as ED

model = RandomHeisenberg(N=6, h=3.0)
model.seed = 2021
ed = ED(model.mpo)
print(ed.evals)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-5.725274   -5.72107734 -4.74615997 -4.71268557 -4.06178764 -3.51217086
 -3.25686868 -3.1702727  -3.08738826 -2.96569967 -2.96208476 -2.36976171
 -2.2468987  -1.96518603 -1.93061032 -1.66092774 -1.63521806 -1.53696184
 -1.53608151 -1.50235556 -1.3824775  -1.30353663 -1.28495105 -0.74151444
 -0.48708556 -0.46889621 -0.38280498 -0.32933783  0.02287853  0.02405187
  0.11860807  0.14026275  0.25916564  0.26466405  0.29724328  0.41903877
  0.52586047  0.57210892  0.73767002  0.99008145  0.99912061  1.28296561
  1.39148235  1.50087939  1.58252137  1.62971816  1.79899183  1.80060276
  1.82251982  2.32711     2.35072418  2.42976868  2.51529568  2.62638576
  2.77518678  2.78965217  3.0927528   3.37982529  3.39238364  3.40923678
  3.59608887  4.2094474   4.42301798  5.18876342]
</pre></div></div>
</div>
<p>whereas for tSDRG, and with truncated bond dimensions <span class="math">\chi &lt; 2**N</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>from tnpy.tsdrg import TSDRG

tsdrg = TSDRG(model.mpo, chi=32)
tsdrg.run()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2021-10-27 16:56:05 [tsdrg.py] INFO: step 1, merging TreeNode(4) and TreeNode(5) to TreeNode(7)
2021-10-27 16:56:05 [tsdrg.py] INFO: step 2, merging TreeNode(2) and TreeNode(3) to TreeNode(8)
2021-10-27 16:56:05 [tsdrg.py] INFO: step 3, merging TreeNode(8) and TreeNode(7) to TreeNode(9)
2021-10-27 16:56:05 [tsdrg.py] INFO: step 4, merging TreeNode(1) and TreeNode(9) to TreeNode(10)
2021-10-27 16:56:05 [tsdrg.py] INFO: step 5, merging TreeNode(0) and TreeNode(10) to TreeNode(11)
2021-10-27 16:56:05 [tsdrg.py] INFO: Reach head node of the tree
2021-10-27 16:56:05 [tsdrg.py] INFO: Obtain ground state energies [-5.725274   -5.72107734 -4.74615997 -4.71268557 -4.06178764 -3.51217086
 -3.25686868 -3.1702727  -3.08738826 -2.96569967 -2.96208476 -2.36976171
 -2.2468987  -1.96518603 -1.93061032 -1.66092774 -1.63521806 -1.53696184
 -1.53608151 -1.50235556 -1.3824775  -1.30353663 -1.28495105 -0.74151444
 -0.48708556 -0.46889621 -0.38280498 -0.32933783  0.02287853  0.02405187
  0.11860807  0.14026275]
</pre></div></div>
</div>
<p>but if we take the maximum bond dimensions <span class="math">\chi = 2 ** N</span>, which is 64 here, then the result will then be exact.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>tsdrg = TSDRG(model.mpo, chi=64)
tsdrg.run()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2021-10-27 16:56:14 [tsdrg.py] INFO: step 1, merging TreeNode(4) and TreeNode(5) to TreeNode(7)
2021-10-27 16:56:14 [tsdrg.py] INFO: step 2, merging TreeNode(2) and TreeNode(3) to TreeNode(8)
2021-10-27 16:56:14 [tsdrg.py] INFO: step 3, merging TreeNode(8) and TreeNode(7) to TreeNode(9)
2021-10-27 16:56:14 [tsdrg.py] INFO: step 4, merging TreeNode(1) and TreeNode(9) to TreeNode(10)
2021-10-27 16:56:14 [tsdrg.py] INFO: step 5, merging TreeNode(0) and TreeNode(10) to TreeNode(11)
2021-10-27 16:56:14 [tsdrg.py] INFO: Reach head node of the tree
2021-10-27 16:56:14 [tsdrg.py] INFO: Obtain ground state energies [-5.725274   -5.72107734 -4.74615997 -4.71268557 -4.06178764 -3.51217086
 -3.25686868 -3.1702727  -3.08738826 -2.96569967 -2.96208476 -2.36976171
 -2.2468987  -1.96518603 -1.93061032 -1.66092774 -1.63521806 -1.53696184
 -1.53608151 -1.50235556 -1.3824775  -1.30353663 -1.28495105 -0.74151444
 -0.48708556 -0.46889621 -0.38280498 -0.32933783  0.02287853  0.02405187
  0.11860807  0.14026275  0.25916564  0.26466405  0.29724328  0.41903877
  0.52586047  0.57210892  0.73767002  0.99008145  0.99912061  1.28296561
  1.39148235  1.50087939  1.58252137  1.62971816  1.79899183  1.80060276
  1.82251982  2.32711     2.35072418  2.42976868  2.51529568  2.62638576
  2.77518678  2.78965217  3.0927528   3.37982529  3.39238364  3.40923678
  3.59608887  4.2094474   4.42301798  5.18876342]
</pre></div></div>
</div>
<div class="section" id="Correlation-function">
<h2><span class="section-number">3.1. </span>Correlation function<a class="headerlink" href="#Correlation-function" title="Permalink to this headline">Â¶</a></h2>
<div><p><img alt="ee13825e985a42218237dc285d7a2556" class="no-scaled-link" src="_images/tsdrg3.png" style="width: 800px;" /></p>
</div><div class="section" id="Depth-first-Search-(DFS)-&amp;-Common-Ancestor">
<h3><span class="section-number">3.1.1. </span>Depth-first Search (DFS) &amp; Common Ancestor<a class="headerlink" href="#Depth-first-Search-(DFS)-&-Common-Ancestor" title="Permalink to this headline">Â¶</a></h3>
</div>
</div>
<div class="section" id="Entanglement-entropy">
<h2><span class="section-number">3.2. </span>Entanglement entropy<a class="headerlink" href="#Entanglement-entropy" title="Permalink to this headline">Â¶</a></h2>
</div>
</div>
<div class="section" id="References-ðŸš€">
<h1><span class="section-number">4. </span>References ðŸš€<a class="headerlink" href="#References-ðŸš€" title="Permalink to this headline">Â¶</a></h1>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.96.064427">Griffiths singularities in the random quantum Ising antiferromagnet: A tree tensor network renormalization group study</a></p></li>
<li><p><a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.89.214203">Self-assembling tensor networks and holography in disordered spin chains</a></p></li>
</ol>
</div>


              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="_autosummary/tnpy.tsdrg.TSDRG.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">tnpy.tsdrg.TSDRG</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="model_base.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Model Base</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Tan Tao-Lin<br/>
        
            &copy; Copyright 2021, Tan Tao-Lin.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>